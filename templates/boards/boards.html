{% extends 'base.html' %}
{% load staticfiles %}

{% block body %}
    {% include 'nav_bar.html' %}
    <!-- Design for modals -->
    <!-- Update Board Modal  -->

    <div class="modal fade modal-fixed" id="EditBoardModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Update Board Name</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
                                {% if board_form.board_name.errors %}
                                {% for error in board_form.board_name.errors %}
                                    <div class="alert alert-danger error-box-boards">
                                        <strong>{{ error }}</strong>
                                    </div>
                                {% endfor %}
                                {% endif %}
          <form name="EditModal" method="post" novalidate="">
            {% csrf_token %}
              <div class="modal-body">
                {{ board_form.board_name }}       
            </div>
              <div class="modal-footer">
                <button name="EditModal" type="submit" class="btn btn-primary">Update Board</button>
              </div>
        </form>
        </div>
      </div>
    </div>
    <!-- Archiving Modal -->
    <div class="modal fade modal-fixed" id="ArchiveBoardModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Archive Board</h5>
          </div>
          <form name="ArchiveBoardModal" method="post" novalidate="">
            {% csrf_token %}
              <div class="modal-body">
                    Are you sure you want to archive this board?
            </div>
              <div class="modal-footer">
                <button name="ArchiveBoardModal" type="submit" class="btn btn-primary">Yes</button>
                 <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
              </div>
        </form>
        </div>
      </div>
    </div>
    <!-- Invite Member Modal -->
    <div class="modal fade modal-fixed" id="AddMemberModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Invite Member</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
                                
          <form name="AddMemberModal" method="post" novalidate="">
            {% csrf_token %}

              <div class="modal-body">
                    <label for="" class="label-margin">Email</label>
                    {{ member_form.email }}
                    {% if member_form.email.errors %}
                                {% for error in member_form.email.errors %}
                                    <div class="alert alert-danger error-box-member-invite">
                                        <strong>{{ error }}</strong>
                                    </div>
                                {% endfor %}
                        {% endif %}
                </div>

              <div class="modal-footer">
                <button name="AddMemberModal" type="submit" class="btn btn-primary">Invite</button>
              </div>
        </form>
        </div>
      </div>
    </div>
    <!-- Remove Member Modal -->

    <form name="RemoveMemberModal" method="post" novalidate="">

    {% csrf_token %}
            <!-- Inner Confirmation Modal -->
        <div class="modal fade modal-fixed" id="RemoveConfirmationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>

                  <div class="modal-body">
                        Are you sure you want to remove these?
                    </div>

                  <div class="modal-footer">
                    <button name="RemoveMemberModal" type="submit" class="btn btn-primary">Yes</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>

                  </div>
          
            </div>
          </div>
        </div>
    <div class="modal fade modal-fixed" id="RemoveMemberModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Remove Member</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
                                

              <div class="modal-body">
                    <center>
                    <div id = "reactor">
                    </div>
                    </center>
                    {% for member in board_member %}
                        
                            {% if member.is_confirmed %}
                            <div class="form-check">
                                <label class="form-check-label">
                                <fieldset id="checkArray">
                                    <input name="remove_member" class="form-check-input" type="checkbox" value="{{member.id}}">
                                     {{ member.user.email }}   
                                     

                                </fieldset>
                                </label>
                            </div>
                            {% endif %}
                    {% endfor %}
                    {% for member in referral %}
                        
                            <div class="form-check">
                                <label class="form-check-label">
                                <fieldset id="checkArray">
                                    <input name="remove_member" class="form-check-input" type="checkbox" value="{{member.board_member.id}}">
                                    {% if not member.is_confirmed %}
                                     {{ member.email }} (Pending)   
                                     {% endif %}

                                </fieldset>
                                </label>
                            </div>
                    {% endfor %}
                </div>

              <div class="modal-footer">
                  <span id="btnRemove"> <button type="button" class="btn btn-secondary" >Remove</button></span>
              </div>
        </div>
      </div>
    </div>
    </form>
       
    <!-- leaving confirmation modal -->
     <div class="modal fade modal-fixed" id="LeaveConfirmationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
                  <form name="LeaveConfirmationModal" method="post" novalidate="">

                  {% csrf_token %}

                  <div class="modal-body">
                        Are you sure you want to leave this group?
                    </div>

                  <div class="modal-footer">
                    <button name="LeaveConfirmationModal" type="submit" class="btn btn-primary">Yes</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                  </div>
                  </form>
          
            </div>
          </div>
        </div>
    <!-- Message Box Modal Alert -->
    {% if message_box %}
        <div class="modal fade modal-fixed" id="MessageBoxModalAlert" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">{{ message_box.title }}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
                                    
              <div name="MessageBoxModalAlert" novalidate="">
                {% csrf_token %}

                  <div class="modal-body">
                            <div class="alert alert-success">
                                <strong>{{ message_box.message }}</strong>
                            </div>
                                    
                    </div>

                  <div class="modal-footer">
                    <button name="MessageBoxModalAlert" class="btn btn-primary" data-dismiss="modal">{{ message_box.button }}</button>
                  </div>
            </div>
            </div>
          </div>
        </div>

    {% endif %}
     <!-- card modal-->
     <!-- Large modal -->
    <div class="modal fade bd-example-modal-lg" id="CardModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
           <div class="modal-content">
              <div class="modal-header">

                <h5 class="modal-title" id="exampleModalLabel">Card Title</h5>
                  <div class="dropdown ml-auto text-right">
                    <a class="btn btn-primary dropdown-toggle" href="https://example.com" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Members
                    </a>

                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                      <a class="dropdown-item" data-toggle="modal" data-target="#AddMemberModal">Invite Member</a>
                      {% if board_member %}
                          <a class="dropdown-item" data-toggle="modal" data-target="#RemoveMemberModal">Remove Member</a>
                      {% endif %}
                    </div>
                  </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>

              </div>
                                    
              <div class="card-description" name="" novalidate="">
                    Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc,
                  <div class="modal-footer">


                    <button name="MessageBoxModalAlert" class="btn btn-primary" data-dismiss="modal">{{ message_box.button }}</button>
                  </div>
            </div>
            </div>
      </div>
    </div>
    <!-- Design for page elements -->
    <div class="row custom-row">
        <div class="col-lg-8 col-md-6 col-sm-5 col-xs-5 ">
            <p class="custom-boards-title"> {{ board.name }} </p>
        </div>
        <div class="col-lg-4 col-md-6 col-sm-7 col-xs-7 show custom-boards-dropdown form-inline">
            {% if owner %}
                <div class="dropdown ml-auto">

              <a class="btn btn-primary dropdown-toggle" href="https://example.com" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Members
              </a>

              <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                <a class="dropdown-item" data-toggle="modal" data-target="#AddMemberModal">Invite Member</a>
                {% if board_member %}
                    <a class="dropdown-item" data-toggle="modal" data-target="#RemoveMemberModal">Remove Member</a>
                {% endif %}
              </div>
            </div>
                <div class="dropdown ml-3 text-right dropdown-right">
                  <a class="btn btn-primary dropdown-toggle" href="https://example.com" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Settings
                  </a>

                  <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <a class="dropdown-item" data-toggle="modal" data-target="#EditBoardModal">Update Board</a>
                    <a class="dropdown-item" data-toggle="modal" data-target="#ArchiveBoardModal">Archive Board</a>
                  </div>
                </div>
            {% else %}
              <div class="dropdown ml-auto text-right dropdown-right">
                  <a class="btn btn-primary dropdown-toggle" href="https://example.com" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Settings
                  </a>

                  <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <a class="dropdown-item" data-toggle="modal" data-target="#LeaveConfirmationModal">Leave Board</a>
                  </div>
                </div>
            {% endif %}
        </div>

    </div>
    <!--  Board Dynamic Design Stuff -->
    <div class ="outer-wrap">
         

    
        <div class="inner-wrap">
            {% for column in columns %}
            <div class="floatbox">
              <!-- Column name -->
                   <div id="existing-label-{{column.id}}" class="existing-reactor" data-value="{{ column.id }}">
                      <label data-value="{{ column.id }}" class="existing-label form-control title-column-class non-editable-add-column" placeholder="Add List">{{ column.name }}</label>
                      <form id="archive-form" action="{% url 'boards:archive_column' id=board.id %}" data-url="{% url 'boards:archive_column' id=board.id %}" data-value="{{column.id}}" novalidate="">
                        <a id="archived-settings"  class="list-settings"><button class="link-style list-settings" type="submit">[X]</button></a>
                    </form>
                  </div>
                    <form  id="existing-form-{{column.id}}"class="existing-form"  data-value="{{ column.id }}"  action="{% url 'boards:update_column' id=board.id %}" data-url="{% url 'boards:update_column' id=board.id %}">
                        <input id="exist-list-{{column.id}}" class="form-control title-column-class" data-value="{{column.id}}" value="{{column.name}}"> 
                        <button name="AddColumn" type="submit" class="btn btn-success btn-add-list">Update</button> 
                        <button id="close-add-list" type="button" class="btn btn-secondary close-add-list">Cancel</button>  
                    </form>

                    <hr>

                   
                {% for card in cards %}
                    {% if card.column == column %}
                      <div id="existing-card-{{column.id}}" data-card_id={{card.id}} class="card-reactor " data-toggle="modal" data-target="#CardModal" data-value="{{ column.id }}">
                        <center>
                        <label data-value="{{ column.id }}" class=" form-control card-column-class non-editable-add-card">{{card.name}}</label>
                        </center>
                        <form id="archive-form" action="{% url 'boards:archive_column' id=board.id %}" data-url="{% url 'boards:archive_column' id=board.id %}" data-value="{{column.id}}" novalidate="">
                      </form>
                    </div>
                    
                <!-- Add Card -->
                      <form  id="existing-form-{{column.id}}"class="existing-form"  data-value="{{ column.id }}"  action="{% url 'boards:update_column' id=board.id %}" data-url="{% url 'boards:update_column' id=board.id %}">
                          <input id="exist-list-{{column.id}}" class="form-control title-column-class" data-value="{{column.id}}" value="{{card.name}}"> 
                          <button name="AddColumn" type="submit" class="btn btn-success btn-add-list">Update</button> 
                          <button id="close-add-list" type="button" class="btn btn-secondary close-add-list">Cancel</button>  
                      </form>
                    {% endif %}
                {% endfor %}


                    <div class="add-card-reactor-{{column.id}}">
                      <label class="form-control title-card-class non-editable-add-card" data-value="{{column.id}}" placeholder="Add List">Add Card</label>
                  </div>

                  <form id="card-add-form-column-{{column.id}}" class="card-add-form-class toggle-card" action="{% url 'boards:add_card' id=board.id %}" data-url="{% url 'boards:add_card' id=board.id %}" data-value="{{column.id}}">
                      <input id="add-card-{{column.id}}" class="form-control title-column-class" placeholder="Enter Another Card Here"> 
                      <button name="AddColumn" type="submit" class="btn btn-success btn-add-card">Add</button> 
                      <button id="close-add-card" data-value="{{column.id}}" type="button" class="btn btn-secondary close-add-card">Cancel</button>  
                  </form>
              </div>
            {% endfor %}
              <div class="floatbox">
                  <div class="add-input-reactor">
                      <label class="form-control title-column-class non-editable-add-column" placeholder="Add List">Add List</label>
                  </div>

                  <form id="list-form" action="{% url 'boards:add_column' id=board.id %}" data-url="{% url 'boards:add_column' id=board.id %}">
                      <input id="add-list" class="form-control title-column-class" placeholder="Enter Another List Here"> 
                      <button name="AddColumn" type="submit" class="btn btn-success btn-add-list">Add</button> 
                      <button id="close-add-list" type="button" class="btn btn-secondary close-add-list">Cancel</button>  
                  </form>
              </div>
                <!--  Used for bug fixing a new board -->
                  
        </div>  
    </div>
</div>
      <input id="hidden-card-add-values" type="hidden" value="{% url 'boards:add_card' id=board.id %}" data-url="{% url 'boards:add_card' id=board.id %}"></input>
      <input id="hidden-column-archive-values" type="hidden" value="{% url 'boards:archive_column' id=board.id %}" data-url="{% url 'boards:archive_column' id=board.id %}"></input>
      <input id="hidden-column-update-values" type="hidden" value="{% url 'boards:update_column' id=board.id %}" data-url="{% url 'boards:update_column' id=board.id %}"></input>  
{% endblock %}
